fit_lm_trt <- function(dat) {
  fit <- lm(y ~ x1, data = dat)
  coefs <- summary(fit)$coefficients
  
  if (!("x1" %in% rownames(coefs))) {
    # x1 has no variation in this sample -> slope not identifiable
    return(list(beta_hat = NA_real_, se_hat = NA_real_))
  }
  
  list(
    beta_hat = unname(coefs["x1", "Estimate"]),
    se_hat   = unname(coefs["x1", "Std. Error"])
  )
}
