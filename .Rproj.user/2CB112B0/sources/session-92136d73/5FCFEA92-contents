---
title: "BIOS 731 HW2"
author: "Baijia Xu"
date: "2026-02-10"
output: pdf_document
---

Here is the URL for my Github repo: <https://github.com/BXU69/bios731_hw2_xu>.

## Problem 1.1 ADEMP Structure

- **A (Aim):** 

The goal is to evaluate and compare three approaches for constructing a 95% confidence interval for the treatment effect in linear regression: (i) Wald intervals, (ii) nonparametric bootstrap percentile intervals, and (iii) nonparametric bootstrap t intervals, under varying sample size, true treatment effect, and error distribution.

- **D (Data-generating mechanism):** 

Data are generated from the multiple linear regression model $$Y_i = \beta_0 + \beta_{treatment}X_{i1} + \mathbf{Z_i}^T\boldsymbol{\gamma} + \epsilon_i$$
with primary focus on $\beta_{treatment}$. It is acceptable to simulate without confounders (i.e., $\gamma=0$). We generate $X_{i1}$ as a binary treatment indicator (e.g., $X_{i1} \sim$ Bernoulli(0.5)). 

We vary three design factors in a full factorial design:
(1). $n \in \{10, 50, 500\}$

(2). $\beta_{treatment} \in \{0, 0.5, 2\}$

(3). error distribution: (i). normal errors: $\epsilon_i \sim N(0, 2)$; (ii). heavy-tailed errors: $\epsilon_i \sim t_{\nu}$ with $\nu=3$, scaled to have variance 2.

- **E (Estimand):** 

The estimand is $\beta_{treatment}$, the average treatment effect.

- **M (Methods):**

(1). Wald confidence intervals (standard model-based approach),
(2). Nonparametric bootstrap **percentile** intervals,
(3). Nonparametric bootstrap **$t$** intervals.

- **P (Performance measures):**

Across repeated simulations, we summarize:

(1). Bias of $\hat{\beta}_{treatment}$,

(2). Coverage of each 95% CI method,

(3). Distribution of $\hat{se}(\hat{\beta})$,

(4). Computation time for each CI method. 

18 simulation scenarios will be run ($3\times \times 3 \times 2$).

### Problem 1.2 nSim 

$$
\sqrt{\frac{p(1-p)}{n_{sim}}} \leq 0.01 \Rightarrow n_{sim} \geq \frac{0.95\times 0.05}{0.01^2} = 475
$$
Therefore we use 475 simulations per scenario.

### Problem 1.3 Implementation 

